<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>List12-5 : DHTMLサンプル</title>

<style type="text/css">

#stage {
    width: 400px;
    height: 300px;
    background-image: url("castle.jpg");
    background-position: 0 0;
}

#stage p {
    padding: 1em;
}

</style>

<script type="text/javascript">

var timer;
var i = 0;
var distance = 842 - 400;  //移動距離（背景画像の幅-ステージの幅）

//①右へ移動
function goRight() {
    clearInterval(timer);  //タイマーの初期化
    timer = setInterval(right, 50);
        //新規タイマーを設定してright関数を実行
}

//②左へ移動
function goLeft() {
    clearInterval(timer);
    timer = setInterval(left, 50);
}

//③右へ移動（実際の処理）
function right() {
    if (i < distance) {
        i++;
        document.getElementById("stage")
                .style.backgroundPosition
                = (i * -1) + "px 0";
    } else {  //④背景画像が右端まで表示された場合
        clearInterval(timer);
        goLeft();
    }
}

//⑤左へ移動（実際の処理）
function left() {
    if (i > 0) {
        i--;
        document.getElementById("stage")
                .style.backgroundPosition
                = (i * -1) + "px 0";
    } else { //⑥
        clearInterval(timer);
        goRight();
    }
}

</script>

</head>

<body onload="goRight();">
<div id="stage">
    <p>背景画像がスクロールします。<p>
</div>
</body>
</html>
